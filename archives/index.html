<!DOCTYPE html>
<html>

<head>
  
  <title>文章归档 - hirako</title>
  <meta charset="UTF-8">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  

  <link rel="shortcut icon" href="/favicon.ico" type="image/png" />
  <meta property="og:type" content="website">
<meta property="og:title" content="hirako">
<meta property="og:url" content="https:&#x2F;&#x2F;hirako.top&#x2F;archives&#x2F;index.html">
<meta property="og:site_name" content="hirako">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="hirako">
<meta name="twitter:card" content="summary">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/css/mdui.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.15.8/styles/atom-one-dark.css">
   
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1038733_0xvrvpg9c0r.css">
  <link rel="stylesheet" href="/css/style.css?v=1576480028395">
<meta name="generator" content="Hexo 4.1.1"></head>

<body class="mdui-drawer-body-left">
  
  <div id="nexmoe-background">
    <div class="nexmoe-bg" style="background-image: url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1576254628884&amp;di=ac190b0ace273a9f12944bf017f316fe&amp;imgtype=0&amp;src=http%3A%2F%2Fcdn.duitang.com%2Fuploads%2Fitem%2F201408%2F17%2F20140817094234_e3FfP.jpeg)"></div>
    <div class="mdui-appbar mdui-shadow-0">
      <div class="mdui-toolbar">
        <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">menu</i></a>
        <div class="mdui-toolbar-spacer"></div>
        <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
        <a href="/" title="hirako" class="mdui-btn mdui-btn-icon"><img src="/images/hirako.jpg"></a>
       </div>
    </div>
  </div>
  <div id="nexmoe-header">
      <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="hirako">
            <img src="/images/hirako.jpg" alt="hirako">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>2</div>
        <div><span>标签</span>0</div>
        <div><span>分类</span>0</div>
    </div>
    <ul class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/about.html" title="关于博客">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博客
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </ul>
    <aside id="nexmoe-sidebar">
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">社交按钮</h3>
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://space.bilibili.com/20238211" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/nexmoe/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
  
  

  
  
  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li></ul>
    </div>
  </div>


  
</aside>
    <div class="nexmoe-copyright">
        &copy; 2019 hirako
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://nexmoe.com/hexo-theme-nexmoe.html" target="_blank">Nexmoe</a>
    </div>
</div><!-- .nexmoe-drawer -->
  </div>
  <div id="nexmoe-content">
    <div class="nexmoe-primary">
        <section class="nexmoe-posts" id="brand-waterfall">
    
    <div class="nexmoe-post">
        <a href="/2019/12/16/hello-world/">
            <div class="nexmoe-post-cover mdui-ripple"> 
                
                    <img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1576254628884&amp;di=ac190b0ace273a9f12944bf017f316fe&amp;imgtype=0&amp;src=http%3A%2F%2Fcdn.duitang.com%2Fuploads%2Fitem%2F201408%2F17%2F20140817094234_e3FfP.jpeg" alt="Hello World">
                
                <h1>Hello World</h1>
            </div>
        </a>
        <div class="nexmoe-post-meta">
            <a><i class="nexmoefont icon-calendar-fill"></i>2019年12月16日</a>
            <a><i class="nexmoefont icon-areachart"></i>78 字</a>
            <a><i class="nexmoefont icon-time-circle-fill"></i>大概 1 分钟</a>
            
            
        </div>
        <article>
            
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>

            
        </article>
    </div>
    
    <div class="nexmoe-post">
        <a href="/2019/12/16/SQNU-CTF2019WP-1/">
            <div class="nexmoe-post-cover mdui-ripple"> 
                
                    <img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1576254628884&amp;di=ac190b0ace273a9f12944bf017f316fe&amp;imgtype=0&amp;src=http%3A%2F%2Fcdn.duitang.com%2Fuploads%2Fitem%2F201408%2F17%2F20140817094234_e3FfP.jpeg" alt="SQNU_CTF2019WP">
                
                <h1>SQNU_CTF2019WP</h1>
            </div>
        </a>
        <div class="nexmoe-post-meta">
            <a><i class="nexmoefont icon-calendar-fill"></i>2019年12月16日</a>
            <a><i class="nexmoefont icon-areachart"></i>846 字</a>
            <a><i class="nexmoefont icon-time-circle-fill"></i>大概 4 分钟</a>
            
            
        </div>
        <article>
            
            <p>###just click</p>
<p>看了逆向工程核心原理光刚门逆向，就找了实验吧的逆向那个题拿来练手，选了一个just click练手</p>
<p>打开程序后发现是一个窗口里面4个按钮排列，索性随便点了几下于是就关了。</p>
<p>于是乎直接上OD结果没有出现任何的反编译代码，直接就运行窗口，点了几下，窗口关闭，OD才显现代码但是已经是retn处了（至于为什么这样，希望喵总解答）</p>
<p>后来就认为是不是有壳，就用PEID查壳，结果</p>
<p>UPolyX V0.5后来看了很多也没头绪，很多帖子是未知壳子，（OD没用还是没有响应。）</p>
<p>于是用EXEInfoPE看了一下pe结构</p>
<p>发现是.net文件，没学过，后来查了一下可以用ILspy来反编译并学习工具的用法，打开工具后是这样的</p>
<p>然后打开反编译的文件，新增了一条我的文件名的选项，后点击加好，又有很多子菜单你，反编译代码就在这里</p>
<p>我们想要的代码在app里面没看懂，mainwindow的代码粘贴下来</p>
<p>using System;<br>using System.CodeDom.Compiler;<br>using System.ComponentModel;<br>using System.Diagnostics;<br>using System.Windows;<br>using System.Windows.Controls;<br>using System.Windows.Markup;</p>
<p>namespace rev4<br>{<br>    public class MainWindow : Window, IComponentConnector<br>    {<br>        private bool first;</p>
<pre><code>    private int hit;

    private int correct;//定义成员数据

    internal StackPanel sp1;

    internal StackPanel sp2;

    internal StackPanel sp3;

    internal StackPanel sp4;

    internal TextBlock tb1;

    internal Button bt1;

    internal Button bt2;

    internal Button bt3;

    internal Button bt4;//定义所有的键

    private bool _contentLoaded;

    public MainWindow() //初始化所有成员数据
    {
        this.InitializeComponent();
        this.first = true;
        this.hit = 0;
        this.correct = 0;
    }

    private void bt1_Click(object sender, RoutedEventArgs e)
    {
        this.btn_Checker(1);
    }

    private void bt2_Click(object sender, RoutedEventArgs e)
    {
        this.btn_Checker(2);
    }

    private void bt3_Click(object sender, RoutedEventArgs e)
    {
        this.btn_Checker(3);
    }

    private void bt4_Click(object sender, RoutedEventArgs e)  //以上相同功能设置每个按钮所传递的值
    {
        this.btn_Checker(4);
    } 

    private void btn_Checker(int para) 
    {
        int[] array = new int[]   //这里就是按动的按钮顺序
        {
            0,
            1,
            3,
            4,
            2,
            1,
            2,
            3,
            4
        };
        bool flag = this.hit &lt; 8;  //比较按动次数是否为8次
        if (flag)
        {
            int num = this.hit;
            this.hit = num + 1;
        }
        else
        {
            base.Close();
        }
        bool flag2 = this.first;
        if (flag2)  
        {
            this.tb1.Text = &quot;&quot;;
            this.first = false;
        }
        bool flag3 = array[this.hit] == para; //比较我按动按钮传递的值和数组中的数比较
        if (flag3)
        {
            int num = this.correct;
            this.correct = num + 1;
        }
        bool flag4 = this.correct == 8;          //当八个都按对，弹出成功，得到flag
        if (flag4)
        {
            MessageBox.Show(&quot;Succeed!&quot;);
            TextBlock textBlock = this.tb1;
            textBlock.Text = string.Concat(new string[]
            {
                textBlock.Text,
                this.sp1.Tag.ToString(),
                this.sp2.Tag.ToString(),
                this.sp3.Tag.ToString(),
                this.sp4.Tag.ToString()
            });
        }
    }

    [GeneratedCode(&quot;PresentationBuildTasks&quot;, &quot;4.0.0.0&quot;), DebuggerNonUserCode]
    public void InitializeComponent()
    {
        bool contentLoaded = this._contentLoaded;
        if (!contentLoaded)
        {
            this._contentLoaded = true;
            Uri resourceLocator = new Uri(&quot;/rev4;component/mainwindow.xaml&quot;, UriKind.Relative);
            Application.LoadComponent(this, resourceLocator);
        }
    }

    [GeneratedCode(&quot;PresentationBuildTasks&quot;, &quot;4.0.0.0&quot;), EditorBrowsable(EditorBrowsableState.Never), DebuggerNonUserCode]
    void IComponentConnector.Connect(int connectionId, object target)
    {
        switch (connectionId)
        {
        case 1:
            this.sp1 = (StackPanel)target;
            break;
        case 2:
            this.sp2 = (StackPanel)target;
            break;
        case 3:
            this.sp3 = (StackPanel)target;
            break;
        case 4:
            this.sp4 = (StackPanel)target;
            break;
        case 5:
            this.tb1 = (TextBlock)target;
            break;
        case 6:
            this.bt1 = (Button)target;
            this.bt1.Click += new RoutedEventHandler(this.bt1_Click);
            break;
        case 7:
            this.bt2 = (Button)target;
            this.bt2.Click += new RoutedEventHandler(this.bt2_Click);
            break;
        case 8:
            this.bt3 = (Button)target;
            this.bt3.Click += new RoutedEventHandler(this.bt3_Click);
            break;
        case 9:
            this.bt4 = (Button)target;
            this.bt4.Click += new RoutedEventHandler(this.bt4_Click);
            break;
        default:
            this._contentLoaded = true;
            break;
        }
    }
}</code></pre><p>}<br>可以看到就是跟密码锁一样，点击按钮顺序得到flag</p>
<p>————————————————<br>版权声明：本文为CSDN博主「网安界的小学生」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/qq_16829209/article/details/79279075" target="_blank" rel="noopener">https://blog.csdn.net/qq_16829209/article/details/79279075</a></p>

            
        </article>
    </div>
    
</section>

    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/js/mdui.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
 
    <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>


 
    <script src="https://cdn.jsdelivr.net/npm/smoothscroll-for-websites@1.4.9/SmoothScroll.min.js"></script>


<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.8/build/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="/js/app.js?v=1576480028401"></script>
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.1.0/lazysizes.min.js"></script>


    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/xtaodada/xtaodada.github.io@0.0.2/copy.js"></script>



  





</body>

</html>
